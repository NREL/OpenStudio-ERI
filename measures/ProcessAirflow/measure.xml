<measure>
  <schema_version>3.0</schema_version>
  <name>process_airflow</name>
  <uid>c4dde5f8-45aa-4381-93dc-e598f7c31155</uid>
  <version_id>109d068b-4122-4b9a-9dd4-3e23e8ab21c8</version_id>
  <xml_checksum>2AC0F979</xml_checksum>
  <class_name>ProcessAirflow</class_name>
  <display_name>Add Residential Airflow Properties</display_name>
  <description>This measure processes infiltration for the living space, garage, finished basement, unfinished basement, crawlspace, and unfinished attic. It also processes mechanical ventilation and natural ventilation for the living space.</description>
  <modeler_description>Using EMS code, this measure processes the building's airflow (infiltration, mechanical ventilation, and natural ventilation).</modeler_description>
  <arguments>
    <argument>
      <name>selectedliving</name>
      <display_name>Living Zone</display_name>
      <description>The living zone.</description>
      <type>Choice</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <choices>
        <choice>
          <value>NA</value>
          <display_name>NA</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedinflivingspace</name>
      <display_name>Air Leakage: Above-Grade Living Space ACH50</display_name>
      <description>Air exchange rate, in Air Changes per Hour at 50 Pascals (ACH50), for above-grade living space (including finished attic).</description>
      <type>Double</type>
      <units>1/hr</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>7</default_value>
    </argument>
    <argument>
      <name>userdefinedconstinflivingspace</name>
      <display_name>Air Leakage: Above-Grade Living Space Constant ACH</display_name>
      <description>Air exchange rate, in natural Air Changes per Hour (ACH), for above-grade living space. Using this variable will override the AIM-2 calculation method with a constant air exchange rate.</description>
      <type>Double</type>
      <units>1/hr</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>userdefinedinfsheltercoef</name>
      <display_name>Air Leakage: Shelter Coefficient</display_name>
      <description>The local shelter coefficient (AIM-2 infiltration model) accounts for nearby buildings, trees and obstructions.</description>
      <type>String</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>auto</default_value>
    </argument>
    <argument>
      <name>selectedgarage</name>
      <display_name>Garage Zone</display_name>
      <description>The garage zone.</description>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>NA</default_value>
      <choices>
        <choice>
          <value>NA</value>
          <display_name>NA</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>selectedfbsmt</name>
      <display_name>Finished Basement Zone</display_name>
      <description>The finished basement zone.</description>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>NA</default_value>
      <choices>
        <choice>
          <value>NA</value>
          <display_name>NA</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedinffbsmt</name>
      <display_name>Finished Basement: Constant ACH</display_name>
      <description>Constant air exchange rate, in Air Changes per Hour (ACH), for the finished basement.</description>
      <type>Double</type>
      <units>1/hr</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>selectedufbsmt</name>
      <display_name>Unfinished Basement Zone</display_name>
      <description>The unfinished basement zone.</description>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>NA</default_value>
      <choices>
        <choice>
          <value>NA</value>
          <display_name>NA</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedinfufbsmt</name>
      <display_name>Unfinished Basement: Constant ACH</display_name>
      <description>Constant air exchange rate, in Air Changes per Hour (ACH), for the unfinished basement. A value of 0.10 ACH or greater is recommended for modeling Heat Pump Water Heaters in unfinished basements.</description>
      <type>Double</type>
      <units>1/hr</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.1</default_value>
    </argument>
    <argument>
      <name>selectedcrawl</name>
      <display_name>Crawlspace Zone</display_name>
      <description>The crawlspace zone.</description>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>NA</default_value>
      <choices>
        <choice>
          <value>NA</value>
          <display_name>NA</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedinfcrawl</name>
      <display_name>Crawlspace: Constant ACH</display_name>
      <description>Air exchange rate, in Air Changes per Hour at 50 Pascals (ACH50), for the crawlspace.</description>
      <type>Double</type>
      <units>1/hr</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>selectedunfinattic</name>
      <display_name>Unfinished Attic Zone</display_name>
      <description>The unfinished attic zone.</description>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>NA</default_value>
      <choices>
        <choice>
          <value>NA</value>
          <display_name>NA</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedinfunfinattic</name>
      <display_name>Unfinished Attic: SLA</display_name>
      <description>Ratio of the effective leakage area (infiltration and/or ventilation) in the unfinished attic to the total floor area of the attic.</description>
      <type>Double</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.00333</default_value>
    </argument>
    <argument>
      <name>userdefinedneighboroffset</name>
      <display_name>Neighbors: Neighbor Offset</display_name>
      <description>The minimum distance between the simulated house and the neighboring houses (not including eaves) [ft].</description>
      <type>Double</type>
      <units>ft</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>userdefinedhomeage</name>
      <display_name>Age of Home</display_name>
      <description>Age of home [Enter 0 for New Construction].</description>
      <type>Double</type>
      <units>yrs</units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>selectedterraintype</name>
      <display_name>Site Terrain</display_name>
      <description>The terrain of the site.</description>
      <type>Choice</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>suburban</default_value>
      <choices>
        <choice>
          <value>ocean</value>
          <display_name>ocean</display_name>
        </choice>
        <choice>
          <value>plains</value>
          <display_name>plains</display_name>
        </choice>
        <choice>
          <value>rural</value>
          <display_name>rural</display_name>
        </choice>
        <choice>
          <value>suburban</value>
          <display_name>suburban</display_name>
        </choice>
        <choice>
          <value>city</value>
          <display_name>city</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>selectedventtype</name>
      <display_name>Ventilation strategy used (none, exhaust, supply, or balanced).</display_name>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>exhaust</default_value>
      <choices>
        <choice>
          <value>none</value>
          <display_name>none</display_name>
        </choice>
        <choice>
          <value>exhaust</value>
          <display_name>exhaust</display_name>
        </choice>
        <choice>
          <value>supply</value>
          <display_name>supply</display_name>
        </choice>
        <choice>
          <value>balanced</value>
          <display_name>balanced</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>selectedinfilcredit</name>
      <display_name>Mechanical Ventilation: Include Infil Credit for Existing Homes</display_name>
      <description>If True, the ASHRAE 62.2 infiltration credit will be included for buildings with infiltration that exceeds a default rate of 2 cfm per 100sqft of finished floor area.</description>
      <type>Boolean</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>true</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedtotaleff</name>
      <display_name>Mechanical Ventilation: Total Recovery Efficiency</display_name>
      <description>The net total energy (sensible plus latent, also called enthalpy) recovered by the supply airstream adjusted by electric consumption, case heat loss or heat gain, air leakage and airflow mass imbalance between the two airstreams, as a percent of the potential total energy that could be recovered plys the exhaust fan energy.</description>
      <type>Double</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>userdefinedsenseff</name>
      <display_name>Mechanical Ventilation: Sensible Recovery Efficiency</display_name>
      <description>The net sensible energy recovered by the supply airstream as adjusted by electric consumption, case heat loss or heat gain, air leakage, airflow mass imbalance between the two airstreams and the energy used for defrost (when running the Very Low Temperature Test), as a percent of the potential sensible energy that could be recovered plus the exhaust fan energy.</description>
      <type>Double</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>userdefinedfanpower</name>
      <display_name>Mechanical Ventilation: Fan Power</display_name>
      <description>Fan power (in W) per delivered airflow rate (in cfm) of fan(s) providing whole house ventilation. If the house uses a balanced ventilation system thtere is assumed to be two fans operating at this efficiency.</description>
      <type>Double</type>
      <units>W/cfm</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.3</default_value>
    </argument>
    <argument>
      <name>userdefinedfracofashrae</name>
      <display_name>Mechanical Ventilation: Fraction of ASHRAE 62.2</display_name>
      <description>Fraction of the ventilation rate (including any infiltration credit) specified by ASHRAE 62.2 that is desired in the bulding.</description>
      <type>Double</type>
      <units>frac</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>1</default_value>
    </argument>
    <argument>
      <name>selectedashraestandard</name>
      <display_name>Mechanical Ventilation: ASHRAE 62.2 Standard</display_name>
      <description>Specifies which version (year) of the ASHRAE 62.2 Standard should be used.</description>
      <type>Choice</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>2010</default_value>
      <choices>
        <choice>
          <value>2010</value>
          <display_name>2010</display_name>
        </choice>
        <choice>
          <value>2013</value>
          <display_name>2013</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefineddryerexhaust</name>
      <display_name>Clothes Dryer: Exhaust</display_name>
      <description>Rated flow capacity of the clothes dryer exhaust. This fan is assumed to run 60 min/day between 11am and 12pm.</description>
      <type>Double</type>
      <units>cfm</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>100</default_value>
    </argument>
    <argument>
      <name>userdefinedhtgoffset</name>
      <display_name>Natural Ventilation: Heating Season Setpoint Offset</display_name>
      <description>The temperature offset below the hourly cooling setpoint, to which the living space is allowed to cool during months that are only in the heating season.</description>
      <type>Double</type>
      <units>degrees F</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>1</default_value>
    </argument>
    <argument>
      <name>userdefinedclgoffset</name>
      <display_name>Natural Ventilation: Cooling Season Setpoint Offset</display_name>
      <description>The temperature offset above the hourly heating setpoint, to which the living space is allowed to cool during months that are only in the cooling season.</description>
      <type>Double</type>
      <units>degrees F</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>1</default_value>
    </argument>
    <argument>
      <name>userdefinedovlpoffset</name>
      <display_name>Natural Ventilation: Overlap Season Setpoint Offset</display_name>
      <description>The temperature offset above the maximum heating setpoint, to which the living space is allowed to cool during months that are in both the heating season and cooling season.</description>
      <type>Double</type>
      <units>degrees F</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>1</default_value>
    </argument>
    <argument>
      <name>selectedheatingssn</name>
      <display_name>Natural Ventilation: Heating Season</display_name>
      <description>True if windows are allowed to be opened during months that are only in the heating season.</description>
      <type>Boolean</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>true</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>selectedcoolingssn</name>
      <display_name>Natural Ventilation: Cooling Season</display_name>
      <description>True if windows are allowed to be opened during months that are only in the cooling season.</description>
      <type>Boolean</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>true</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>selectedoverlapssn</name>
      <display_name>Natural Ventilation: Overlap Season</display_name>
      <description>True if windows are allowed to be opened during months that are in both the heating season and cooling season.</description>
      <type>Boolean</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>true</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
    </argument>
    <argument>
      <name>userdefinedventweekdays</name>
      <display_name>Natural Ventilation: Number Weekdays</display_name>
      <description>Number of weekdays in the week that natural ventilation can occur.</description>
      <type>Double</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>3</default_value>
    </argument>
    <argument>
      <name>userdefinedventweekenddays</name>
      <display_name>Natural Ventilation: Number Weekend Days</display_name>
      <description>Number of weekend days in the week that natural ventilation can occur.</description>
      <type>Double</type>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
    </argument>
    <argument>
      <name>userdefinedfracwinopen</name>
      <display_name>Natural Ventilation: Fraction of Openable Windows Open</display_name>
      <description>Specifies the fraction of the total openable window area in the building that is opened for ventilation.</description>
      <type>Double</type>
      <units>frac</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.33</default_value>
    </argument>
    <argument>
      <name>userdefinedfracwinareaopen</name>
      <display_name>Natural Ventilation: Fraction Window Area Openable</display_name>
      <description>Specifies the fraction of total window area in the home that can be opened (e.g. typical sliding windows can be opened to half of their area).</description>
      <type>Double</type>
      <units>frac</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.2</default_value>
    </argument>
    <argument>
      <name>userdefinedhumratio</name>
      <display_name>Natural Ventilation: Max OA Humidity Ratio</display_name>
      <description>Outdoor air humidity ratio above which windows will not open for natural ventilation.</description>
      <type>Double</type>
      <units>frac</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.0115</default_value>
    </argument>
    <argument>
      <name>userdefinedrelhumratio</name>
      <display_name>Natural Ventilation: Max OA Relative Humidity</display_name>
      <description>Outdoor air relative humidity (0-1) above which windows will not open for natural ventilation.</description>
      <type>Double</type>
      <units>frac</units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>0.7</default_value>
    </argument>
    <argument>
      <name>num_bedrooms</name>
      <display_name>Number of bedrooms.</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>3</default_value>
    </argument>
    <argument>
      <name>num_bathrooms</name>
      <display_name>Number of bathrooms.</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>2</default_value>
    </argument>
    <argument>
      <name>finished_floor_area</name>
      <display_name>Finished floor area [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>2700</default_value>
    </argument>
    <argument>
      <name>above_grade_finished_floor_area</name>
      <display_name>Above grade finished floor area [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>2700</default_value>
    </argument>
    <argument>
      <name>building_height</name>
      <display_name>Height of building [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>24.5</default_value>
    </argument>
    <argument>
      <name>stories</name>
      <display_name>Number of stories.</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>2</default_value>
    </argument>
    <argument>
      <name>window_area</name>
      <display_name>Window area [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>348</default_value>
    </argument>
    <argument>
      <name>livingspacevolume</name>
      <display_name>Volume of living space [ft^3].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>21600</default_value>
    </argument>
    <argument>
      <name>livingspaceheight</name>
      <display_name>Height of living space [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>16</default_value>
    </argument>
    <argument>
      <name>livingspacearea</name>
      <display_name>Area of living space [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>2700</default_value>
    </argument>
    <argument>
      <name>uavolume</name>
      <display_name>Volume of unfinished attic [ft^3].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>5250</default_value>
    </argument>
    <argument>
      <name>uaheight</name>
      <display_name>Height of unfinished attic [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>8.5</default_value>
    </argument>
    <argument>
      <name>uaarea</name>
      <display_name>Area of unfinished attic [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>1500</default_value>
    </argument>
    <argument>
      <name>cvolume</name>
      <display_name>Volume of crawlspace [ft^3].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>4800</default_value>
    </argument>
    <argument>
      <name>cheight</name>
      <display_name>Height of crawlspace [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>4</default_value>
    </argument>
    <argument>
      <name>carea</name>
      <display_name>Area of crawlspace [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>1200</default_value>
    </argument>
    <argument>
      <name>gvolume</name>
      <display_name>Volume of garage [ft^3].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>2400</default_value>
    </argument>
    <argument>
      <name>gheight</name>
      <display_name>Height of garage [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>8</default_value>
    </argument>
    <argument>
      <name>garea</name>
      <display_name>Area of garage [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>300</default_value>
    </argument>
    <argument>
      <name>fbvolume</name>
      <display_name>Volume of finished basement [ft^3].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>9600</default_value>
    </argument>
    <argument>
      <name>fbheight</name>
      <display_name>Height of finished basement [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>8</default_value>
    </argument>
    <argument>
      <name>fbarea</name>
      <display_name>Area of finished basement [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>1200</default_value>
    </argument>
    <argument>
      <name>ufbvolume</name>
      <display_name>Volume of unfinished basement [ft^3].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>9600</default_value>
    </argument>
    <argument>
      <name>ufbheight</name>
      <display_name>Height of unfinished basement [ft].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>8</default_value>
    </argument>
    <argument>
      <name>ufbarea</name>
      <display_name>Area of unfinished basement [ft^2].</display_name>
      <type>Double</type>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>1200</default_value>
    </argument>
  </arguments>
  <provenances/>
  <tags>
    <tag>Envelope.Infiltration</tag>
  </tags>
  <attributes>
    <attribute>
      <name>Measure Type</name>
      <value>EnergyPlusMeasure</value>
      <datatype>string</datatype>
    </attribute>
    <attribute>
      <name>Uses SketchUp API</name>
      <value>false</value>
      <datatype>boolean</datatype>
    </attribute>
  </attributes>
  <files>
    <file>
      <filename>ProcessAirflow_Test.rb</filename>
      <filetype>rb</filetype>
      <usage_type>test</usage_type>
      <checksum>6EEE80CB</checksum>
    </file>
    <file>
      <filename>util.rb</filename>
      <filetype>rb</filetype>
      <usage_type>resource</usage_type>
      <checksum>3D1ABA94</checksum>
    </file>
    <file>
      <filename>ASHRAE622WSF.csv</filename>
      <filetype>csv</filetype>
      <usage_type>resource</usage_type>
      <checksum>1C1BB835</checksum>
    </file>
    <file>
      <filename>weather.rb</filename>
      <filetype>rb</filetype>
      <usage_type>resource</usage_type>
      <checksum>CD6B0BDF</checksum>
    </file>
    <file>
      <filename>sim.rb</filename>
      <filetype>rb</filetype>
      <usage_type>resource</usage_type>
      <checksum>61F7758E</checksum>
    </file>
    <file>
      <version>
        <software_program>OpenStudio</software_program>
        <identifier>1.4.0</identifier>
        <min_compatible>1.4.0</min_compatible>
      </version>
      <filename>measure.rb</filename>
      <filetype>rb</filetype>
      <usage_type>script</usage_type>
      <checksum>A3F74578</checksum>
    </file>
  </files>
</measure>
